---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import AuthCheck from '../../components/AuthCheck.astro';
import { getSession } from 'auth-astro/server';

const session = await getSession(Astro.request);
---

<AuthCheck>
	<html lang="en">
		<head>
			<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
			<style>
				main {
					width: 100%;
					max-width: 100%;
					margin: 0;
					padding: 3rem 0;
					background: var(--theme-bg);
					color: var(--theme-text);
				}
				.content {
					width: 720px;
					max-width: calc(100% - 2em);
					margin: auto;
					padding: 1em;
				}
				.auth-info {
					background: var(--theme-bg-accent);
					border-radius: 0.75rem;
					padding: 2rem;
					margin: 2rem 0;
				}
				.auth-info pre {
					background: var(--theme-bg);
					padding: 1rem;
					border-radius: 0.5rem;
					overflow-x: auto;
				}
				.success-message {
					color: #22c55e;
					font-weight: 600;
					margin-bottom: 1rem;
				}
			</style>
		</head>

		<body>
			<Header />
			<main>
				<div class="content">
					<h1>Builder Authentication Test</h1>
					<div class="auth-info">
						<p class="success-message">âœ“ Authentication Successful!</p>
						<p>Welcome, {session?.user?.name}! You're successfully authenticated as a builder.</p>
						<h2>Session Information:</h2>
						<pre>
							{JSON.stringify(session, null, 2)}
						</pre>
					</div>
				</div>
			</main>
			<Footer />
		</body>
	</html>
</AuthCheck>
